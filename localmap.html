<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>台北旅遊指南</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet" />
<style>
body {
  background: #000;
  color: #fff;
  font-family: "Montserrat", "Noto Sans TC", sans-serif;
  margin: 0;
  height: 100%;
}
.container {
  display: flex;
  height: 100vh;
  min-height: 100vh;
  flex-wrap: nowrap;
  overflow: hidden;
}
.sidebar {
  width: 35%;
  max-width: 420px;
  min-width: 0;
  background: #111;
  border-right: 1px solid rgba(255,255,255,.08);
  overflow-y: auto;
  padding: 1rem;
  -webkit-overflow-scrolling: touch;
}
h2 { font-weight:700; margin-bottom:.6rem; }
.section-tabs { display:flex; gap:.5rem; flex-wrap:wrap; margin-bottom:.8rem; }
.section-tabs button {
  background:transparent; color:#fff; border:1px solid rgba(255,255,255,.3);
  padding:.35rem .8rem; border-radius:20px; cursor:pointer;
}
.section-tabs button.active, .section-tabs button:hover {
  background:#fff; color:#000;
}
.filter-tags { display:flex; flex-wrap:wrap; gap:.4rem; margin-bottom:1rem; }
.tag {
  padding:.3rem .8rem; border-radius:14px; font-size:.8rem; font-weight:600;
  color:#fff; border:1px solid transparent; cursor:pointer; transition:.25s;
}
.tag:hover { transform:scale(1.05); box-shadow:0 0 8px rgba(255,255,255,.4); }
.tag.active { border:1px solid #fff; box-shadow:0 0 12px rgba(255,255,255,.6); }
.location { border-bottom:1px solid rgba(255,255,255,.1); margin-bottom:1rem; padding-bottom:1rem; display:flex; gap:.75rem; cursor:pointer; }
.location img { width:100px; height:70px; object-fit:cover; border-radius:4px; flex-shrink:0; }
.location-info h3 { font-size:1.1rem; margin-bottom:.2rem; font-weight:600; }
.location-info p { font-size:.9rem; color:rgba(255,255,255,.8); margin-bottom:.3rem; }
.read-more { font-size:.85rem; color:#fff; text-decoration:underline; cursor:pointer; }
.map { flex:1; background:#111; display:flex; align-items:center; justify-content:center; z-index:0; }
.map p { color:#aaa; text-align:center; }
.detail-panel {
  position:absolute; top:0; right:-100%; width:400px; max-width:100%; height:100%;
  background:#111; border-left:1px solid rgba(255,255,255,.1); padding:1.5rem;
  transition:right .4s ease; overflow-y:auto; z-index:2;
}
.detail-panel.open { right:0; }
.close-btn { position:absolute; top:10px; right:10px; background:none; border:none; font-size:1.5rem; color:#fff; cursor:pointer; }

/* Chatbot */
.chat-widget { position:fixed; right:20px; bottom:20px; z-index:9999; display:flex; flex-direction:column; align-items:flex-end; gap:10px; cursor:move; }
.chat-btn { background:linear-gradient(135deg,#ffcc70,#ff7eb3); border:none; border-radius:50px; padding:14px 20px; font-weight:700; font-size:15px; cursor:pointer; color:#111; box-shadow:0 6px 20px rgba(0,0,0,.4); transition:transform .2s ease; }
.chat-btn:hover { transform:scale(1.05); }
.chat-panel {
  position:absolute; bottom:60px; right:0; width:380px; max-width:92vw;
  background:rgba(255,255,255,.07); backdrop-filter:blur(12px) saturate(180%);
  border-radius:18px; overflow:hidden; box-shadow:0 10px 30px rgba(0,0,0,.5);
  border:1px solid rgba(255,255,255,.15); display:flex; flex-direction:column;
  opacity:0; transform:translateY(20px); pointer-events:none; visibility:hidden;
  transition:opacity .3s ease, transform .3s ease, visibility 0s linear .3s;
}
.chat-panel.open { opacity:1; transform:translateY(0); pointer-events:auto; visibility:visible; }
.chat-header { padding:14px 16px; display:flex; align-items:center; justify-content:space-between; background:rgba(0,0,0,.4); border-bottom:1px solid rgba(255,255,255,.1); }
.brand { font-weight:800; font-size:16px; letter-spacing:.5px; }
.desc { font-size:12px; color:rgba(255,255,255,.75); }
.chat-area { padding:16px; display:flex; flex-direction:column; gap:12px; min-height:220px; max-height:50vh; overflow-y:auto; overflow-x:hidden; box-sizing:border-box; }
.bubble { max-width:90%; padding:12px 14px; border-radius:18px; line-height:1.4; font-size:14px; box-shadow:0 4px 10px rgba(0,0,0,.2); word-wrap:break-word; overflow-wrap:break-word; box-sizing:border-box; }
.bubble.user { align-self:flex-end; background:linear-gradient(135deg,#a8ff78,#78ffd6); color:#000; border-bottom-right-radius:6px; }
.bubble.bot { align-self:flex-start; background:linear-gradient(135deg,#84fab0,#8fd3f4); color:#000; border-bottom-left-radius:6px; }
.quick-actions { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:6px; }
.quick-btn { background:rgba(255,255,255,.15); border:none; border-radius:10px; padding:8px 12px; font-size:13px; cursor:pointer; color:#fff; backdrop-filter:blur(6px); transition:background .2s; }
.quick-btn:hover { background:rgba(255,255,255,.25); }
.chat-input-row { display:flex; gap:8px; padding:12px; border-top:1px solid rgba(255,255,255,.1); background:rgba(0,0,0,.3); }
#chatInput { flex:1; min-height:42px; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.2); background:rgba(255,255,255,.05); color:#fff; outline:none; resize:none; }
#chatInput::placeholder { color:rgba(255,255,255,.5); }
#sendChatBtn { padding:10px 14px; border-radius:12px; border:none; background:linear-gradient(135deg,#ffcc70,#ff7eb3); color:#111; font-weight:700; cursor:pointer; min-width:70px; box-shadow:0 4px 12px rgba(0,0,0,.3); }

/* Responsive */
@media (max-width:768px){
  .container { flex-direction: column; height:auto; min-height:100vh; }
  .sidebar { width:100%; max-width:none; min-width:0; border-bottom:1px solid rgba(255,255,255,.1); }
  .map { width:100%; height:50vh; }
  .detail-panel { width:100% !important; right:0 !important; top:0; height:100%; border-left:none; border-top:1px solid rgba(255,255,255,.1); border-radius:0; }
  .chat-panel { width:90vw; bottom:70px; right:5vw; max-width:none; }
}
</style>
</head>
<body>

<div class="container">
  <aside class="sidebar">
    <h2>探索台北</h2>
    <div class="section-tabs">
      <button class="tab-btn active" data-section="best">精選推薦</button>
      <button class="tab-btn" data-section="neighborhoods">各區導覽</button>
      <button class="tab-btn" data-section="themes">主題體驗</button>
      <button class="tab-btn" data-section="tips">旅遊小貼士</button>
    </div>
    <div class="filter-tags">
      <span class="tag wanhua" data-filter="wanhua">萬華</span>
      <span class="tag xinyi" data-filter="xinyi">信義</span>
      <span class="tag shilin" data-filter="shilin">士林</span>
      <span class="tag beitou" data-filter="beitou">北投</span>
    </div>

    <div class="tab-content" id="best">
      <div class="location" data-district="xinyi" data-title="台北101" data-lat="25.033964" data-lng="121.564468" data-desc="地標摩天大樓，觀景台與購物中心。">
        <img src="https://via.placeholder.com/100x70" alt="Taipei 101">
        <div class="location-info"><h3>台北101</h3><p>信義區 <span class="tag xinyi">信義</span></p><a href="javascript:void(0)" class="read-more">更多資訊</a></div>
      </div>
      <div class="location" data-district="shilin" data-title="國立故宮博物院" data-lat="25.102398" data-lng="121.548309" data-desc="世界級博物館，收藏中國藝術與歷史文物。">
        <img src="https://via.placeholder.com/100x70" alt="國立故宮博物院">
        <div class="location-info"><h3>國立故宮博物院</h3><p>士林區 <span class="tag shilin">士林</span></p><a href="javascript:void(0)" class="read-more">更多資訊</a></div>
      </div>
    </div>
  </aside>

  <main class="map">
    <p>🗺️ 地圖功能即將推出</p>
  </main>

  <div class="detail-panel" id="detailPanel">
    <button class="close-btn" id="closePanel">&times;</button>
    <h3 id="detailTitle"></h3>
    <p id="detailDesc"></p>
  </div>
</div>

<!-- Chatbot -->
<div class="chat-widget" id="chatWidget">
  <button class="chat-btn" id="chatToggle">💬 旅遊助理</button>
  <div class="chat-panel" id="travelChatPanel">
    <div class="chat-header">
      <div>
        <div class="brand">AI 旅遊助理 ✈️</div>
        <div class="desc">可詢問景點、叫 Uber、規劃行程、訂飯店</div>
      </div>
      <div>
        <button id="closeChatPanel" style="background:none;border:none;color:#fff;cursor:pointer;font-weight:700">✕</button>
      </div>
    </div>
    <div class="chat-area" id="chatArea"></div>
    <div style="padding:0 12px 10px;">
      <div class="quick-actions" id="quickActions">
        <button class="quick-btn" data-msg="建議景點">建議景點 🗺️</button>
        <button class="quick-btn" data-msg="叫 Uber">叫 Uber 🚕</button>
        <button class="quick-btn" data-msg="規劃行程">規劃行程</button>
        <button class="quick-btn" data-msg="訂飯店">訂飯店 🏨</button>
      </div>
      <div class="chat-input-row">
        <textarea id="chatInput" placeholder="輸入您的旅遊問題..."></textarea>
        <button id="sendChatBtn">傳送</button>
      </div>
    </div>
  </div>
</div>

<script>
// Tabs
document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const section=btn.dataset.section;
    document.querySelectorAll('.tab-content').forEach(tab=>{
      tab.style.display=(tab.id===section)?'block':'none';
    });
  });
});

// Filter Tags
const tags = document.querySelectorAll('.filter-tags .tag');
const locations = document.querySelectorAll('.location');
tags.forEach(tag=>{
  tag.addEventListener('click',()=>{
    const filter = tag.dataset.filter;
    const isActive = tag.classList.contains('active');
    tags.forEach(t=>t.classList.remove('active'));
    if(!isActive){
      tag.classList.add('active');
      locations.forEach(loc=>{
        loc.style.display=(loc.dataset.district===filter)?'flex':'none';
      });
    } else { locations.forEach(loc=>loc.style.display='flex'); }
  });
});

// Slide Panel
const panel = document.getElementById('detailPanel');
const panelTitle = document.getElementById('detailTitle');
const panelDesc = document.getElementById('detailDesc');
document.querySelectorAll('.read-more, .location').forEach(el=>{
  el.addEventListener('click',(e)=>{
    const loc = e.target.closest('.location');
    panelTitle.textContent = loc.dataset.title;
    panelDesc.textContent = loc.dataset.desc;
    panel.classList.add('open');
  });
});
document.getElementById('closePanel').addEventListener('click',()=>panel.classList.remove('open'));

// Chatbot
const chatToggle = document.getElementById('chatToggle');
const chatPanel = document.getElementById('travelChatPanel');
const closeChatPanel = document.getElementById('closeChatPanel');
const chatArea = document.getElementById('chatArea');
const chatInput = document.getElementById('chatInput');
const sendChatBtn = document.getElementById('sendChatBtn');
const quickActions = document.getElementById('quickActions');
const chatWidget = document.getElementById('chatWidget');

chatToggle.addEventListener('click', ()=>chatPanel.classList.toggle('open'));
closeChatPanel.addEventListener('click', ()=>chatPanel.classList.remove('open'));

function appendBubble(text, who='bot', isMap=false){
  const div = document.createElement('div'); div.className='bubble '+(who==='user'?'user':'bot');
  if(isMap){
    const mapUrl = `https://www.google.com/maps?q=${encodeURIComponent(text)}&output=embed`;
    div.innerHTML=`<div>${text}</div><iframe width="100%" height="200" style="border:0;border-radius:12px;margin-top:6px;" loading="lazy" allowfullscreen src="${mapUrl}"></iframe>`;
  } else div.textContent=text;
  chatArea.appendChild(div); div.scrollIntoView({behavior:'smooth'});
}

// Mock responses
async function sendUserMessage(text){
  appendBubble(text,'user');
  let reply='';
  if(text.includes('建議景點')) reply='台北101, 士林夜市';
  else if(text.toLowerCase().includes('uber')) reply='請輸入上車地點，我可以幫您查找附近的 Uber 司機。';
  else if(text.includes('規劃')) reply='我可以幫你規劃 2 天行程，請問您什麼時候出發？';
  else if(text.includes('訂飯店')) reply='請輸入入住日期與地點，我可以幫您搜尋附近飯店。';
  else reply='我可以建議景點、叫 Uber、規劃行程或訂飯店。';
  // Show map bubble if asking about 景點
  appendBubble(reply,'bot', text.includes('建議景點'));
}

quickActions.addEventListener('click', e=>{
  const btn = e.target.closest('.quick-btn'); if(!btn) return;
  sendUserMessage(btn.dataset.msg);
});
sendChatBtn.addEventListener('click', ()=>{ if(chatInput.value.trim()){ sendUserMessage(chatInput.value.trim()); chatInput.value=''; } });
chatInput.addEventListener('keydown', e=>{ if(e.key==='Enter'&&!e.shiftKey){ e.preventDefault(); sendChatBtn.click(); } });

appendBubble("旅遊助理：嗨！我可以建議景點、叫 Uber、規劃行程或訂飯店。試試快速按鈕！");

// Draggable chat (desktop + touch)
let isDragging=false,offsetX=0,offsetY=0;
function dragStart(e){
  isDragging=true;
  const rect = chatWidget.getBoundingClientRect();
  const clientX = e.touches?e.touches[0].clientX:e.clientX;
  const clientY = e.touches?e.touches[0].clientY:e.clientY;
  offsetX = clientX - rect.left; offsetY = clientY - rect.top;
}
function dragMove(e){
  if(!isDragging) return;
  const clientX = e.touches?e.touches[0].clientX:e.clientX;
  const clientY = e.touches?e.touches[0].clientY:e.clientY;
  chatWidget.style.right='auto';
  chatWidget.style.bottom='auto';
  chatWidget.style.left=(clientX-offsetX)+'px';
  chatWidget.style.top=(clientY-offsetY)+'px';
}
function dragEnd(){ isDragging=false; }
chatWidget.addEventListener('mousedown', dragStart);
chatWidget.addEventListener('touchstart', dragStart);
document.addEventListener('mousemove', dragMove);
document.addEventListener('touchmove', dragMove);
document.addEventListener('mouseup', dragEnd);
document.addEventListener('touchend', dragEnd);

</script>
</body>
</html>
